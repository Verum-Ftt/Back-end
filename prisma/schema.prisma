generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}


model Students {
  id              String              @id            @default(uuid())

  name            String
  email           String              @unique
  active          Boolean             @default(true)
  phone           String              @unique
  RA              String              @unique
  created_at      DateTime            @default(now())

  QrCode   QrCode[]

  @@map("students")
}

model Academics {
  id              String                @id            @default(uuid())

  name            String
  email           String                @unique
  active          Boolean               @default(true)
  phone           String                @unique
  RA              String                @unique
  created_at      DateTime              @default(now())
  password        String

  register        Register[]
  @@map("academics")
}

model QrCode {
  id              String               @id            @default(uuid())
  student_id      String               @unique
  laboratory_id   String               @unique
  sub_event_id    String               @unique

  created_at      DateTime             @default(now())

  student         Students             @relation(fields: [student_id], references: [id])
  laboratory      Laboratory           @relation(fields: [laboratory_id], references: [id])
  sub_event       Sub_event            @relation(fields: [sub_event_id], references: [id])
  register        Register[]

  @@map("qrCode")
}

model Register {
  id              String               @id            @default(uuid())
  qr_code_id      String               @unique
  academic_id     String               @unique

  qrCode          QrCode               @relation(fields: [qr_code_id], references: [id])
  academic        Academics            @relation(fields: [academic_id], references: [id])
  

  @@map("register")
}

model Laboratory {
  id              String               @id            @default(uuid())
  local           String?  
  quantity        Int


  QrCode          QrCode[]
  advice          Advice[]

  @@map("laboratory")
}

model Sub_event {
  id              String               @id            @default(uuid())
  event_id        String               @unique
  group_id        String               @unique
  date            DateTime          

  QrCode          QrCode[]
  advice          Advice[]
  event           Events                @relation(fields: [event_id], references: [id])
  group           Groups                @relation(fields: [group_id], references: [id])

  @@map("sub_event")
}

model Groups {
  id              String                @id            @default(uuid())

  description     String
  hour            DateTime

  sub_event       Sub_event[]
  
  @@map("groups")
}

model Events {
  id              String                 @id            @default(uuid())
  date            DateTime          
  description     String
  
  sub_event       Sub_event[]

  @@map("events")
}

model Advice {
  id              String                @id            @default(uuid())
  laboratory_id   String                @unique
  sub_event_id    String                @unique

  description     String
  tier            tier                  @default(low)

  laboratory      Laboratory            @relation(fields: [laboratory_id], references: [id])
  sub_event       Sub_event             @relation(fields: [sub_event_id], references: [id])
  
  @@map("advice")
}

enum tier {
  low
  medium
  high
}